(()=>{"use strict";var e={3571:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.highterCursor=t.hights=t.hight=void 0;const l=r(o(1854));t.hight=l;const c=r(o(268));t.hights=c;const a={toogle:o(4525).toggleHighterCursor};t.highterCursor=a},6341:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function c(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,c)}a((n=n.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(o(8747)),l=o(9941);t.default=function(e,t,o=window.getSelection()){return n(this,void 0,void 0,(function*(){const n=null==o?void 0:o.toString();if(!n)return;let i=null==o?void 0:o.getRangeAt(0).commonAncestorContainer;for(;i&&i.parentNode&&!("innerHTML"in i);)i=i.parentNode;const c=yield(0,l.store)({selection:o,container:i,url:location.hostname+location.pathname,href:location.href,color:e.color,textColor:e.textColor,level:t}),a={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset};(0,r.default)({selectionString:n,container:i,selection:a,color:e.color,textColor:e.textColor,hightIndex:c,hightLevel:t}),yield chrome.runtime.sendMessage({action:"hight-change"})}))}},4744:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(8941),i=o(3652);function r(e,t,o,n){const{anchor:l,focus:c,anchorOffset:a,focusOffset:u,color:s,textColor:d,hightIndex:h,selectionString:f,hightLevel:g}=t,A=f.length;return e.contents().each(((e,_)=>{if(n>=A)return;if(_.nodeType!==Node.TEXT_NODE){const e=$(_);return void(e.is(":visible")&&"hidden"!==getComputedStyle(_).visibility&&([o,n]=r(e,t,o,n)))}let v=0;if(!o){if(!l.is(_)&&!c.is(_))return;o=1,v=Math.min(...l.is(_)?[a]:[],...l.is(_)?[u]:[])}const{nodeValue:m,parentElement:E}=_;if(m&&v>(null==m?void 0:m.length))throw new Error(`No match found for highlight string '${f}'`);const H=_.splitText(v);let L=v;for(;m&&L<(null==m?void 0:m.length);L++){for(;n<A&&f[n].match(/\s/u);)n++;if(n>=A)break;const e=m[L];if(e===f[n])n++;else if(!e.match(/\s/u))throw new Error(`No match found for highlight string '${f}'`)}if(null==E?void 0:E.classList.contains(i.HIGHTED_CLASS))return;const C=L-v,S=H.splitText(C),T=H.nodeValue;if(null==T?void 0:T.match(/^\s*$/u))return void(null==E||E.normalize());const y=document.createElement("span");y.classList.add("inherit"===s?i.DELETED_CLASS:i.HIGHTED_CLASS),y.style.backgroundColor=s,y.style.color=d,y.dataset.hightId=String(h),y.dataset.hightLevelClass=String(g),y.textContent=H.nodeValue,H.remove(),null==E||E.insertBefore(y,S)})),[o,n]}t.default=function({selectionString:e,container:t,selection:o,color:l,textColor:c,hightIndex:a,hightLevel:u}){console.log("✨✨ hight:",(new Date).toISOString(),"✨✨"),console.log("✨✨",e),console.log("hight color: ",l);const s={color:l||"yellow",textColor:c||"inherit",hightIndex:a,selectionString:e,anchor:$(o.anchorNode),anchorOffset:o.anchorOffset,focus:$(o.focusNode),focusOffset:o.focusOffset,hightLevel:u};try{!function(e,t){r(e,t,0,0)}($(t),s)}catch(e){return!1}return(null==o?void 0:o.removeAllRanges)&&o.removeAllRanges(),$(t).parent().find(`.${i.HIGHTED_CLASS}`).each(((e,t)=>{(0,n.initializeHightEventListener)(t)})),chrome.runtime.sendMessage({action:"set-level",level:u}),!0}},8747:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(o(4744));t.default=function({selectionString:e,container:t,selection:o,color:n,textColor:r,hightIndex:l,hightLevel:c,version:a="1.0"}){return("1.0"===a||void 0===a)&&(0,i.default)({selectionString:e,container:t,selection:o,color:n,textColor:r,hightIndex:l,hightLevel:c})}},1854:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.hight=t.updateColor=t.show=t.removeLost=t.remove=t.create=void 0;const i=n(o(6341));t.create=i.default;const r=n(o(4160));t.remove=r.default;const l=n(o(3956));t.removeLost=l.default;const c=n(o(1058));t.show=c.default;const a=n(o(1629));t.updateColor=a.default;const u=n(o(8747));t.hight=u.default},4160:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(8941),i=o(9941),r=o(3652);t.default=function(e){const t=$(`.${r.HIGHTED_CLASS}[${r.CUSTOM_HIGHT_DATA_ID}='${e}']`);$(`.${r.HOVERED_CLASS}`).removeClass(r.HOVERED_CLASS),t.css("backgroundColor","inherit"),t.css("color","inherit"),t.removeClass(r.HIGHTED_CLASS).addClass(r.DELETED_CLASS),(0,i.update)(e,window.location.hostname+window.location.pathname,0,"inherit","inherit"),t.each(((e,t)=>{(0,n.removeHightEventListeners)(t)})),chrome.runtime.sendMessage({action:"hight-change"})}},3956:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(2274),i=o(9941);t.default=function(e){(0,n.removeLostHight)(e),(0,i.removeHight)(e,window.location.hostname+window.location.pathname),chrome.runtime.sendMessage({action:"hight-change"})}},1058:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(3652);t.default=function(e){const t=document.querySelector(`[${n.CUSTOM_HIGHT_DATA_ID}="${e}"]`);t&&t.scrollIntoView(!0)}},1629:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function c(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,c)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(9941),r=o(3652);t.default=function(e,t,o){return n(this,void 0,void 0,(function*(){o=null!=o?o:yield function(e){const t=document.querySelector(`.${r.HIGHTED_CLASS}[${r.CUSTOM_HIGHT_DATA_ID}='${e}']`).style.backgroundColor;return new Promise((e=>{chrome.runtime.sendMessage({action:"get-color-options"},(({response:o})=>{const n=o.findIndex((e=>e.color===t)),i=o[(n+1)%o.length];e(i)}))}))}(e);const n=$(`.${r.HIGHTED_CLASS}[${r.CUSTOM_HIGHT_DATA_ID}='${e}']`);n.css("backgroundColor",o.color),n.css("colors",o.textColor||"inherit"),n.attr(r.CUSTOM_HIGHT_DATA_LEVEL_CLASS,null),n.attr(r.CUSTOM_HIGHT_DATA_LEVEL_CLASS,t),(0,i.update)(e,window.location.hostname+window.location.pathname,t,o.color,o.textColor),chrome.runtime.sendMessage({action:"set-level",level:t}),chrome.runtime.sendMessage({action:"hight-change"})}))}},2274:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeLostHight=t.getLostHights=t.addHightError=void 0;const n=o(9941),i=new Map;function r(e){(0,n.load)(e.hightVal,e.hightIndex,!0)?i.delete(e.hightIndex):Date.now()-e.errorTime<1e3&&(e.timeout=setTimeout(r,500,e))}t.addHightError=function(e,t){const o={hightVal:e,hightIndex:t,errorTime:Date.now()};o.timeout=setTimeout(r,500,o),i.set(t,o)},t.getLostHights=function(){return i},t.removeLostHight=function(e){const t=i.get(e);t&&"timeout"in t&&(clearTimeout(t.timeout),i.delete(e))}},4525:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getShowHighterCursor=t.toggleHighterCursor=t.initializeHighterCursor=void 0;let o=!1;function n(){if(!o)return;const e=window.getSelection();(null==e?void 0:e.toString())&&chrome.runtime.sendMessage({action:"hight"})}t.initializeHighterCursor=function(){document.addEventListener("mouseup",n)},t.toggleHighterCursor=function(){o=!o,o?(document.body.style.cursor="url(\n      data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYEAYAAACw5+G7AAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAGYktHRAAAAAAAAPlDu38AAAAJcEhZcwAAAGAAAABgAPBrQs8AAAAHdElNRQfnCBECJi90y5CyAAAFDElEQVRYw8VYe0xTdxQ+5/ZSmCKGFXEKzk1GCOBjRoXymAU2JTVWy3AuYiaoSzGLoGiYIjgHbjBwqa4RJ04WZxSHhKKURR0+aKmFogIuPoLEuSxDp446h2Bt6e/sD+2NUbtugazfn989Oef77rm/x7kIw4zowLOHDVkLF8LrXA5Uz5vn5KkZpsPowUFMpxFUfu2aKIJCHTkNDabNcZ8nXb5+HYCICDF6ielNQ6NcDm3YQIlSKQSglAsaO1YoUEMzWGd/P1vPL6VxZWU47AbiTfv1qffvgx3egGw/P1dxdAyk4Ge1cq+BBIs1GpqG70PdrFlgo2V0KjHRbaE1cIwit21DGZ2hM8Tzto3eX3ALpkxhTVwi9zHHsQ8GtaizWs+tji+LL7t8+V8bsJy9rd+7YQOoucW4e9EiaCQx+SJCJAaDjefpS6qE8rAwlEMr/OXj41og5sLtW7fgKxoBu27eFPiZOAgnBgbwJqzG8rVrMVpl0jb1FRfDRXgF2/Pyns2DNvSGC6mprR0xM2TrtNqhdihOYrxrvDt+vL2SG81WGQxYAucpOyRE6EwCTcStanVbaez4txpzcwEQERlzlY+Hi5jFhUgkAFRDNS94o1mS8oGDhYVZv/T21Mr8/YVC+bAX3k5JER8RKxxhy5fbc+1z+I90OvSDfgzIyYEYqmXbU1NpKdyAVUScFZuJr6tjvVB0O1GjMVjubPd9dWCgEyzwdBsyd4dK/ghKSsp+ZCnSbq2vFx/paz9c/Xx+WkA7WUdBAUZHtwQZAisqHhtQqV5gcgtsycw0m2MbZU179gy1A8KLiTbN0SeoVABQCIUVFU7ebI6NlcnQ7do8+ElvT61s5UoeFZDOTjc0ePmLfsWMuDgWyybQhxxn9yUD/mCxAIh+5s4ZjRA6XNKHB3gLp+IlRL61IKY4YbJOd+CRxVJbNGoU1w3tNEiUFvpy3iLdoUOeFuoKbCdl0xqlkheIe7Zz/aqjR1nAU1GrPS3zHwzcs0vRZ8UKwQC/WZzmG7lkCY2jn2gy0WO2stLTQl1BFCVOg9L6esEApsI7XN6JE6wLOh0RTwzoPS3TNZy7EeckHF20zL44PJxbCaewOjzc0wLd4sk2zQ09k2fgPF+ET0gUhvu9Dl+9CkYAmOJpee7hPBiFDlAtnGQlycnMRGqHbu5cTwt0B6aCk9x9tVroQN9M67teE6uqAOBT6PO0PPfw2ubVOLhLoRAMjMzwKbUplUohIhO+gfaqKk8LdQX7RVu7SLFvHyf9rGVT0yWFomJv948B9Zs2fX2l66oksKAgqttUolcYjVHd5pDmkRERnhb8HHiQg1yr5UkH33FJ8+fbwFFDNZGRsB8AAQABZBAOAOA4zfri4wHgOjRdueJp3U4IdyF3gdLMgAkDfVlZ2cm9PbUyh8PJD+E6HYgjNBpD/u8pDyO8vTvH/gkvPVWvcvQdqza9o8P7jqiUQnp6XOVnOymbLVUq//eBJqrbHHKGgoPxNBvHrdPr4VsqA+WkSUJAMtyD8h07zEUx82ZXr1/vbqAZ9pFSOr3lgl6dn09i2gj1KSnCg2EeKeE8lnBtOTmeG+oP4Hs41+FAb5rBbmg0UIUXsG3aNKijGvBPSnJb6MlQ73YN/FdQBi3GuLQ0fIjN1KtQwAHMwFWIz/5WYd87Ornfjh8/vzl+zOwxXV1CB4NaJjTdkMvJhwCCY2Ke/a1CCawNpj54QHVek1mjWv036/aJTd/fKgAAAAAASUVORK5CYII=\n    ), auto",n()):document.body.style.cursor="default"},t.getShowHighterCursor=function(){return o}},8941:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function c(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,c)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.removeHightEventListeners=t.onHightMouseEnterOrClick=t.initializeHightEventListener=t.initializeHoverTools=t.onChangeColorBTNClicked=void 0;const i=o(3652),r=o(1854);let l,c,a,u,s=null,d=null,h=null,f=null,g=null,A=null;function _(e,t){var o,n;const i=e.getBoundingClientRect(),r=i.top-45;if(null===(o=S())||void 0===o||o.css({top:r}),void 0!==t){let e=null;e=i.width<108?i.left+i.width/2-54:t-i.left<54?i.left:i.right-t<54?i.right-108:t-54,null===(n=S())||void 0===n||n.css({left:e})}S().show()}function v(){const e=a.getAttribute(i.CUSTOM_HIGHT_DATA_ID),t=document.querySelectorAll(`.${i.HIGHTED_CLASS}[${i.CUSTOM_HIGHT_DATA_ID}='${e}']`),o=Array.from(t).map((e=>{var t;return null===(t=e.textContent)||void 0===t?void 0:t.replace(/\s+/gmu," ")})).join("");window.navigator.clipboard.writeText(o),chrome.runtime.sendMessage({action:"track-event",trackCategory:"hight-action",trackAction:"copy"})}function m(){var e;const t=Number(a.getAttribute(i.CUSTOM_HIGHT_DATA_ID));(0,r.remove)(t),null===(e=S())||void 0===e||e.hide(),c=null,chrome.runtime.sendMessage({action:"track-event",trackCategory:"hight-action",trackAction:"delete"})}function E(e){return n(this,void 0,void 0,(function*(){const t=a.getAttribute(i.CUSTOM_HIGHT_DATA_ID),o=e.target.getAttribute(i.CUSTOM_HIGHT_DATA_LEVEL);chrome.runtime.sendMessage({action:"track-event",trackCategory:"hight-action",trackAction:"update-level"});const n=Number(o);(0,r.updateColor)(Number(t),n,{color:i.tmpColorArray[Number(o)]})}))}function H(){null!==c&&(clearTimeout(c),c=null)}function L(){u||(c=setTimeout(C,170))}function C(){var e;$(`.${i.HOVERED_CLASS}`).removeClass(i.HOVERED_CLASS),null===(e=S())||void 0===e||e.hide(),c=null,u=!1}function S(){return l.closest("document").length||l.appendTo("body"),l}function T(e){const t=e.target,o=t.getAttribute(`${i.CUSTOM_HIGHT_DATA_ID}`);u&&"click"!==e.type||(u="click"===e.type,null!==c&&(clearTimeout(c),c=null,a&&o===(null==a?void 0:a.getAttribute(i.CUSTOM_HIGHT_DATA_ID)))||(a=t,_(t,e.clientX),$(`.${i.HOVERED_CLASS}`).removeClass(i.HOVERED_CLASS),$(`.${i.HIGHTED_CLASS}[${i.CUSTOM_HIGHT_DATA_ID}='${o}']`).addClass(i.HOVERED_CLASS)))}function y(){u||(c=setTimeout(C,170))}t.initializeHoverTools=function(){$.get(chrome.runtime.getURL("src/hights/hoverTool/index.html"),(e=>{l=$(e),l.hide(),l[0].addEventListener("mouseenter",H),l[0].addEventListener("mouseleave",L),s=l.find(".hight-copy-button")[0],d=l.find(".hight-delete-button")[0],h=l.find("#hight-level-one-button")[0],f=l.find("#hight-level-two-button")[0],g=l.find("#hight-level-three-button")[0],A=l.find("#hight-level-four-button")[0],s.addEventListener("click",v),d.addEventListener("click",m),h.addEventListener("click",E),f.addEventListener("click",E),g.addEventListener("click",E),A.addEventListener("click",E),window.addEventListener("click",(e=>{var t;const o=e.target;(null===(t=null==o?void 0:o.classList)||void 0===t?void 0:t.contains(i.HIGHTED_CLASS))||C()})),window.addEventListener("scroll",(()=>{u&&_(a)}))}))},t.onChangeColorBTNClicked=function(){const e=a.getAttribute(i.CUSTOM_HIGHT_DATA_ID);null!==e&&((0,r.updateColor)(Number(e),0),chrome.runtime.sendMessage({action:"track-event",trackCategory:"hight-action",trackAction:"change-color"}))},t.initializeHightEventListener=function(e){e.addEventListener("mouseenter",T),e.addEventListener("click",T),e.addEventListener("mouseleave",y)},t.removeHightEventListeners=function(e){e.removeEventListener("mouseenter",T),e.removeEventListener("click",T),e.removeEventListener("mouseleave",y)},t.onHightMouseEnterOrClick=T},9338:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const l=r(o(3571)),c=o(268),a=o(8941),u=o(4525);(0,a.initializeHoverTools)(),(0,u.initializeHighterCursor)(),window.highterAPI=l,(0,c.loadAll)()},3881:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function c(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,c)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(9941);t.default=function(){return n(this,void 0,void 0,(function*(){yield(0,i.clearPage)(window.location.hostname+window.location.pathname),window.location.reload()}))}},3857:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(3652);t.default=function(){const e=document.getElementsByClassName(n.HIGHTED_CLASS);return e?Array.from(e).map((e=>{var t;return[e.getAttribute(`${n.CUSTOM_HIGHT_DATA_ID}`),e.getAttribute(`${n.CUSTOM_HIGHT_DATA_LEVEL_CLASS}`),window.getComputedStyle(e,null).getPropertyValue("background-color"),null===(t=e.textContent)||void 0===t?void 0:t.replace(/\s+/gmu," ").trim()]})).reduce(((e,[t,o,n,i])=>(e.has(t)?e.set(t,{hightLevel:o,hightText:`${e.get(t).hightText}${i}`,hightBGColor:n}):e.set(t,{hightLevel:o,hightText:i,hightBGColor:n}),e)),new Map):null}},3670:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(2274);t.default=n.getLostHights},268:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.loadAll=t.deleteAll=t.getAllLost=t.getAllFound=void 0;const i=n(o(3881));t.deleteAll=i.default;const r=n(o(3857));t.getAllFound=r.default;const l=n(o(3670));t.getAllLost=l.default;const c=n(o(622));t.loadAll=c.default},622:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(9941);t.default=function(){function e(){(0,n.loadAll)(window.location.hostname+window.location.pathname)}"loading"===document.readyState?(document.removeEventListener("DOMContentLoaded",e),document.addEventListener("DOMContentLoaded",e)):e()}},9941:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function c(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,c)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.updateLevel=t.update=t.loadAll=t.load=t.removeHight=t.clearPage=t.store=void 0;const i=o(2274),r=o(1854),l=chrome.runtime.getManifest().version;function c(e,t,o){const n={anchorNode:a(e.anchorNode),anchorOffset:e.anchorOffset,focusNode:a(e.focusNode),focusOffset:e.focusOffset},{color:l,string:c,textColor:u,level:s}=e,d=a(e.container);if(!n.anchorNode||!n.focusNode||!d)return o||(0,i.addHightError)(e,t),!1;const h=(0,r.hight)({selectionString:c,container:d,selection:n,color:l,textColor:u,hightIndex:t,hightLevel:s});return o||h||(0,i.addHightError)(e,t),h}function a(e){const t=/>textNode:nth-of-type\(([0-9]+)\)$/iu,o=t.exec(e);if(o){const n=parseInt(o[1],10),i=u(e=e.replace(t,""));return i?i.childNodes[n]:null}return u(e)}function u(e){try{return document.querySelector(e)}catch(t){let o=document;for(const t of e.split(">")){if(!o)return null;const e=/^(.*):nth-of-type\(([0-9]+)\)$/iu.exec(t),[,n,i]=null!=e?e:[void 0,t,1];o=Array.from(o.childNodes).filter((e=>"localName"in e&&e.localName===n))[Number(i)-1]}return o}}function s(e){if("id"in e&&e.id)return`#${t=e.id,t.replace(/(:)/gu,"\\$1")}`;var t;if("localName"in e&&"html"===e.localName)return"html";const o=e.parentNode,n=s(o);if("localName"in e){const t=Array.from(o.childNodes).filter((t=>"localName"in t&&t.localName===e.localName)).indexOf(e)+1;return`${n}>${e.localName}:nth-of-type(${t})`}return`${n}>textNode:nth-of-type(${Array.prototype.indexOf.call(o.childNodes,e)})`}t.store=function({selection:e,container:t,url:o,href:i,color:r,textColor:c,level:a}){return n(this,void 0,void 0,(function*(){const{yu_hight:n}=yield chrome.storage.local.get({yu_hight:{}});n[o]||(n[o]=[]);const u=n[o].push({version:l||"1.0",string:e.toString(),container:s(t),anchorNode:s(e.anchorNode),anchorOffset:e.anchorOffset,focusNode:s(e.focusNode),focusOffset:e.focusOffset,color:r,textColor:c,href:i,uuid:crypto.randomUUID(),createdAt:Date.now(),level:a});return yield chrome.storage.local.set({yu_hight:n}),u-1}))},t.update=function(e,t,o,i,r){return n(this,void 0,void 0,(function*(){const{yu_hight:n}=yield chrome.storage.local.get({yu_hight:{}}),l=n[t];if(l){const t=l[e];t&&(t.color=i,t.textColor=r,t.level=o,t.updatedAt=Date.now(),yield chrome.storage.local.set({yu_hight:n}))}}))},t.updateLevel=function(e,t,o){return n(this,void 0,void 0,(function*(){const{yu_hight:n}=yield chrome.storage.local.get({yu_hight:{}}),i=n[t];if(i){const t=i[e];t&&(t.level=o,t.updatedAt=Date.now(),yield chrome.storage.local.set({yu_hight:n}))}}))},t.load=c,t.loadAll=function(e){return n(this,void 0,void 0,(function*(){const t=yield chrome.storage.local.get({yu_hight:{}});let o=[];if(o=o.concat(t.yu_hight[e]||[]),o)for(let e=0;e<o.length;e++)c(o[e],e)}))},t.removeHight=function(e,t){return n(this,void 0,void 0,(function*(){const{yu_hight:o}=yield chrome.storage.local.get({yu_hight:{}});o[t].splice(e,1),yield chrome.storage.local.set({yu_hight:o})}))},t.clearPage=function(e){return n(this,void 0,void 0,(function*(){const{yu_hight:t}=yield chrome.storage.local.get({yu_hight:{}});delete t[e],yield chrome.storage.local.set({yu_hight:t})}))}},3652:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tmpColorArray=t.HIGHTED_LEVEL_CLASS=t.HIGHTED_LEVEL_FOUR_CLASS=t.HIGHTED_LEVEL_THREE_CLASS=t.HIGHTED_LEVEL_TWO_CLASS=t.HIGHTED_LEVEL_ONE_CLASS=t.CUSTOM_HIGHT_PARENT_DATA_ID=t.CUSTOM_HIGHT_DATA_LEVEL_CLASS=t.CUSTOM_HIGHT_DATA_LEVEL=t.CUSTOM_HIGHT_DATA_ID=t.LEVELED_CLASS=t.HOVERED_CLASS=t.DELETED_CLASS=t.HIGHTED_CLASS=void 0,t.HIGHTED_CLASS="hight-highted",t.DELETED_CLASS="hight-deleted",t.HOVERED_CLASS="hight-hovered",t.LEVELED_CLASS="hight-leveled",t.CUSTOM_HIGHT_DATA_ID="data-hight-id",t.CUSTOM_HIGHT_DATA_LEVEL="data-hight-level",t.CUSTOM_HIGHT_DATA_LEVEL_CLASS="data-hight-level-class",t.CUSTOM_HIGHT_PARENT_DATA_ID="data-hight-parent-id",t.HIGHTED_LEVEL_ONE_CLASS="hight-level-1",t.HIGHTED_LEVEL_TWO_CLASS="hight-level-2",t.HIGHTED_LEVEL_THREE_CLASS="hight-level-3",t.HIGHTED_LEVEL_FOUR_CLASS="hight-level-4",t.HIGHTED_LEVEL_CLASS=["",t.HIGHTED_LEVEL_ONE_CLASS,t.HIGHTED_LEVEL_TWO_CLASS,t.HIGHTED_LEVEL_THREE_CLASS,t.HIGHTED_LEVEL_FOUR_CLASS],t.tmpColorArray=["","#fe4362","#fc9d9b","#ffccad","#c9c8aa"]}},t={};!function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}(9338)})();